import React, { useState } from 'react';
import Container from 'react-bootstrap/Container';

import SearchBar from "./search.js";
import { CVEsSummaryTable } from "./CVEs-summary-table";

import {getCVEs} from '../data-sources/CVE-data-getters';

export default function FindCVEs() {
 const [CVEs, setCVEs] = useState([]);
 const [erredSearch, setErredSearch] = useState(null);

 async function doSearch (searchString) {
   try {
     const result = await getCVEs(searchString);
     // console.log('search result', result);
     setCVEs(result);
   } catch(e) {
     console.log('failed to search for CVEs', e);
     setErredSearch(e.message);
   }
 }

 // and now the render!
 if (erredSearch) {
   return (<div>Failed to get result of search: {erredSearch}</div>)
 }

 return (
   <Container>
     <SearchBar searchTrigger={ doSearch }/>
     <CVEsSummaryTable CVESummaries={CVEs.topResults} />
   </Container>
 );
}
